{{- $baseURL := .Site.BaseURL | strings.TrimRight "/" -}}
{{- $ogLogoAsset := resources.Get "images/bg/W_logo.png" -}}
{{- $ogImageURL := "" -}}
{{- if $ogLogoAsset -}}
  {{- $ogImageURL = printf "%s%s" $baseURL $ogLogoAsset.RelPermalink -}}
{{- end -}}
{{- if .Params.image -}}
  {{- $pageImgAsset := resources.Get (strings.TrimPrefix "/" .Params.image) -}}
  {{- if $pageImgAsset -}}
    {{- $ogImageURL = printf "%s%s" $baseURL $pageImgAsset.RelPermalink -}}
  {{- end -}}
{{- end -}}
{{- $desc := .Summary | plainify -}}
{{- with .Description }}{{- $desc = . -}}{{- end -}}
{{- if not $desc }}{{- $desc = .Site.Params.description -}}{{- end -}}

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="{{ $desc }}">
<meta name="keywords" content="{{ .Site.Params.keywords }}">
<title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>

<!-- Canonical -->
<link rel="canonical" href="{{ .Permalink }}">

<!-- Favicon -->
<link rel="icon" type="image/png" sizes="96x96" href="{{ .Site.Params.favicon }}">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png">
<meta name="theme-color" content="#1a3a28">

<!-- Open Graph -->
<meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
<meta property="og:description" content="{{ $desc }}">
<meta property="og:type" content="{{ if and .IsPage (eq .Type "news") }}article{{ else }}website{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:site_name" content="{{ .Site.Title }}">
{{ with $ogImageURL }}<meta property="og:image" content="{{ . }}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">{{ end }}

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
<meta name="twitter:description" content="{{ $desc }}">
{{ with $ogImageURL }}<meta name="twitter:image" content="{{ . }}">{{ end }}
{{ with .Site.Params.social.twitter }}<meta name="twitter:site" content="@{{ . | replaceRE "^https?://(www\\.)?twitter\\.com/@?" "" }}">{{ end }}

<!-- Article meta (news pages) -->
{{ if and .IsPage (eq .Type "news") }}
<meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
<meta property="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
<meta property="article:section" content="Wildlife Conservation">
<meta property="article:author" content="Wildlife &amp; Nature Conservancy Society">
{{ end }}

<!-- Preconnect for faster external resource loading -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;600;700;800;900&family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<!-- Custom CSS -->
{{- $css := resources.Get "css/custom.css" | fingerprint -}}
<link rel="stylesheet" href="{{ $css.RelPermalink }}">

<!-- Structured Data: Organization (homepage) -->
{{ if .IsHome }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "NGO",
  "name": {{ .Site.Title | jsonify }},
  "alternateName": "WNC India",
  "url": {{ .Site.BaseURL | jsonify }},
  {{ with $ogLogoAsset }}"logo": {{ (printf "%s%s" $baseURL .RelPermalink) | jsonify }},{{ end }}
  "description": {{ .Site.Params.description | jsonify }},
  "email": {{ .Site.Params.email | jsonify }},
  "telephone": {{ .Site.Params.phone | jsonify }},
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "203, Second Floor, Akansha Trade Centre, Opp-Hotel Omni Palace, Geeta Bhawan",
    "addressLocality": "Indore",
    "addressRegion": "Madhya Pradesh",
    "postalCode": "452001",
    "addressCountry": "IN"
  },
  "foundingDate": "{{ .Site.Params.foundingYear }}",
  "sameAs": [
    {{ .Site.Params.social.youtube | jsonify }},
    {{ .Site.Params.social.instagram | jsonify }}
  ]
}
</script>
{{ end }}

<!-- Structured Data: Article (news pages) -->
{{ if and .IsPage (eq .Type "news") }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": {{ .Title | jsonify }},
  "datePublished": {{ .Date.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
  "dateModified": {{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
  "description": {{ $desc | jsonify }},
  {{ with $ogImageURL }}"image": {{ . | jsonify }},{{ end }}
  "author": {
    "@type": "Organization",
    "name": "Wildlife & Nature Conservancy Society",
    "url": {{ .Site.BaseURL | jsonify }}
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wildlife & Nature Conservancy Society",
    "url": {{ .Site.BaseURL | jsonify }}{{ with $ogLogoAsset }},
    "logo": {
      "@type": "ImageObject",
      "url": {{ (printf "%s%s" $baseURL .RelPermalink) | jsonify }}
    }{{ end }}
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ .Permalink | jsonify }}
  }
}
</script>
{{ end }}
